rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // A "Regra de Ouro" para a coleção 'tutors'
    // {userId} é um "coringa" que representa o ID de qualquer documento na coleção.
    match /tutors/{userId} {

      // PERMISSÃO DE ESCRITA (WRITE):
      // 'write' cobre as operações de 'create', 'update' e 'delete'.
      // A condição `if request.auth.uid == userId;` é a verificação de segurança.
      // `request.auth.uid` é o "crachá" do usuário que está logado fazendo a requisição.
      // A regra só permite a escrita se o ID do usuário logado for o mesmo ID do documento
      // que ele está tentando modificar. É por isso que ela resolve o seu problema de 'update'.
      allow write: if request.auth.uid == userId;

      // PERMISSÃO DE LEITURA (READ):
      // 'read' cobre as operações de 'get' (um documento) e 'list' (vários documentos).
      // A mesma lógica se aplica: você só pode ler os dados de um perfil se for o seu.
      allow read: if request.auth.uid == userId;
    }
  }
}
